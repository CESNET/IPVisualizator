<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <title>IP Vizualizator</title>
  </head>
  <body>
    <div class="container" style="margin-top: 20px;">
        <center><h1 class="display-4">IP vizualizator</h1></center>
        
        <p class="pt-4">IPVizualizator je interaktivní mapa, která zobrazuje hodnoty přiřazené k IP adresám pomocí Hilbertovy křivky.</p>
        <h5 class="pt-4">Postup zobrazení svých dat:</h5>
        <ol>
            <li><a href="create_user.html">Na této stránce</a> is vytvořte uživatele, pod kterým budete data nahrávat. Okopírujte si authorizační token.</li>
            <li><a href="send_dataset.html">Zde</a> nahrajte váš dataset v požadovaném formátu. Uložte si token reprezentující daný dataset.</li>
            <li>Pomocí formuláře níže si můžete generovat mapy.</li>
        </ol>
        <form class="pt-4">
            <div class="form-group">
                <label for="token">Token datasetu</label>
                <input type="text" class="form-control" id="token" value="5MC5TjetQf_Fu3Kjke_-2A">
            </div>
            <div class="form-group">
                <label for="network">Síť</label>
                <input type="text" class="form-control" id="network" value="0.0.0.0">
            </div>
            <div class="form-group">
                <label for="mask">Maska sítě</label>
                <input type="number" class="form-control" id="mask" value="0">
            </div>
            <div class="form-group">
                <label for="resolution">Rozlišení</label>
                <input type="number" class="form-control" id="resolution" value="16">
                <small id="res-help" class="form-text text-muted">Maska podsítě, která se na mapě zobrazí jako 1 pixel. Nepovinné</small>

            </div>
            <div class="form-group">
                <label for="size">Rozměry mapy</label>
                    <select class="form-control" id="size">
                        <option value="small">small (512x512px)</option>
                        <option value="regular" selected="selected">regular (768x768px)</option>
                        <option value="large">large (1024x1024px)</option>
                        <option value="xlarge">xlarge (4096x4096)</option>
                    </select>
            </div>
            <div class="form-group form-check">
                <input type="checkbox" class="form-check-input" id="skip_zeros">
                <label class="form-check-label" for="skip_zeros">Neposílat pixely s nulovou hodnotou po síti</label>
            </div>
            <button type="button" id="form-send"  class="btn btn-primary">Zobrazit</button>
        </form>
        <div id="map"></div>
    </div>


    <!-- Optional JavaScript -->
    <!-- jQuery first, Bootstrap JS, D3.js -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="../IPVizualizator-js/IPVizualizator.js"></script>
    <script>
        const vizualizator = new IPVizualizator({
            "id": "#map",
            "api": "http://127.0.0.1:8080/api/v1",
            "token": "5ILUnBwe5rh5X1jnH3GBsw",
            "network": "0.0.0.0",
            "mask": 0,
            "resolution": 16,
            "config": {
                "size": "regular",
                "skip_zeros": false,
                "bordered_pixel": true,
              //"static": true
            },
            "overlay_networks": [
                {
                    "text": "Reserved",
                    "network": "0.0.0.0/8"
                },
                {
                    "text": "Unallocated",
                    "network": "1.0.0.0/8"
                },
                {
                    "text": "Public\nData Network",
                    "network": "14.0.0.0/8"
                },
                {
                    "text": "GE",
                    "network": "3.0.0.0/8"
                },
                {
                    "text": "Unallocated",
                    "network": "2.0.0.0/8"
                },
                {
                    "text": "Xerox",
                    "network": "13.0.0.0/8",
                },
                {
                    "text": "RIPE",
                    "network": "80.0.0.0/4"
                },
                {
                    "text": "Multicast",
                    "network": "224.0.0.0/4"
                },
                {
                    "text": "Reserved",
                    "network": "240.0.0.0/4"
                }
            ]
        });

        $(document).ready(function(){
            token = $("#token").val(vizualizator.token);
            network = $("#network").val(vizualizator.network); 
            mask = $("#mask").val(vizualizator.mask); 
            resolution = $("#resolution").val(vizualizator.resolution);

            $("#form-send").click(function(){
                token = $("#token").val();
                network = $("#network").val(); 
                mask = $("#mask").val(); 
                resolution = $("#resolution").val();
                size = $("#size").val();
                skip_zeros = false;
                if($("#skip_zeros").is(":checked")) skip_zeros = true;

                vizualizator.set_token(token);
                vizualizator.set_network(network);
                vizualizator.set_mask(mask);
                vizualizator.set_resolution(resolution);
                vizualizator.set_canvas_size(size);
                vizualizator.update();
            }); 
        }); 
    </script>
  </body>
</html>
