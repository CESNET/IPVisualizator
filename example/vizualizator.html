<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="../IPVizualizator-js/IPVizualizator.css">

    <title>IP Vizualizator</title>
  </head>
  <body>
    <div class="container" style="margin-top: 20px;">
        <center><h1 class="display-4">IP vizualizator</h1></center>
        
        <p class="pt-4">IPVizualizator je interaktivní mapa, která zobrazuje hodnoty přiřazené k IP adresám pomocí Hilbertovy křivky.</p>
        <h5 class="pt-4">Postup zobrazení svých dat:</h5>
        <ol>
            <li><a href="create_user.html">Na této stránce</a> is vytvořte uživatele, pod kterým budete data nahrávat. Okopírujte si authorizační token.</li>
            <li><a href="send_dataset.html">Zde</a> nahrajte váš dataset v požadovaném formátu. Uložte si token reprezentující daný dataset.</li>
            <li>Pomocí formuláře níže si můžete generovat mapy.</li>
        </ol>
        <form class="pt-4">
            <div class="form-group">
                <label for="token">Token datasetu</label>
                <input type="text" class="form-control" id="token" value="5MC5TjetQf_Fu3Kjke_-2A">
            </div>
            <div class="form-group">
                <label for="network">Síť</label>
                <input type="text" class="form-control" id="network" value="0.0.0.0">
            </div>
            <div class="form-group">
                <label for="mask">Maska sítě</label>
                <input type="number" class="form-control" id="mask" value="0">
            </div>
            <div class="form-group">
                <label for="resolution">Rozlišení</label>
                <input type="number" class="form-control" id="resolution" value="16">
                <small id="res-help" class="form-text text-muted">Maska podsítě, která se na mapě zobrazí jako 1 pixel. Nepovinné</small>

            </div>
            <div class="form-group">
                <label for="width">Šířka obrázku</label>
                <input type="number" class="form-control" id="width" value="800">
            </div>
            <div class="form-group">
                <label for="height">Výška obrázku</label>
                <input type="number" class="form-control" id="height" value="800">
            </div>
            <div class="form-group form-check">
                <input type="checkbox" class="form-check-input" id="skip_zeros">
                <label class="form-check-label" for="skip_zeros">Neposílat pixely s nulovou hodnotou po síti</label>
            </div>
            <button type="button" id="form-send"  class="btn btn-primary">Zobrazit</button>
        </form>
        <div id="canvas" style="position: relative;"></div>
        <div id="tooltip"></div>
    </div>


    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, Bootstrap JS, D3.js -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="../IPVizualizator-js/IPVizualizator.js"></script>
    <script> 
        const vizualizator = new IPVizualizator({
            "canvas": "#canvas",
            "height": "768",
            "width": "768",
            "api": "http://127.0.0.1:8080/api/v1",
            "token": "5ILUnBwe5rh5X1jnH3GBsw",
            "network": "0.0.0.0",
            "mask": 0,
            "resolution": 16,
            "skip_zeros": false,
            "bordered_pixel": true
        });

        $(document).ready(function(){
            token = $("#token").val(vizualizator.token);
            network = $("#network").val(vizualizator.network); 
            mask = $("#mask").val(vizualizator.mask); 
            resolution = $("#resolution").val(vizualizator.resolution);
            width = $("#height").val(vizualizator.canvas_width); 
            height = $("#width").val(vizualizator.canvas_height);

            $("#form-send").click(function(){
                token = $("#token").val();
                network = $("#network").val(); 
                mask = $("#mask").val(); 
                resolution = $("#resolution").val();
                width = $("#height").val(); 
                height = $("#width").val();
                skip_zeros = false;
                if($("#skip_zeros").is(":checked")) skip_zeros = true;

                vizualizator.set_token(token);
                vizualizator.set_network(network);
                vizualizator.set_mask(mask);
                vizualizator.set_resolution(resolution);
                vizualizator.set_skip_zeros(skip_zeros);
                vizualizator.set_canvas_size(width, height);
                vizualizator.update();
            }); 
        }); 
    </script>
  </body>
</html>
